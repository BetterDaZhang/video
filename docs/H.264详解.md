## H.264编码

### 第1章 绪论

#### 1.1 信息化与视频通信

#### 1.2 视频信息和信号的特点

​	直观性、确切性、高效性、广泛性

#### 1.3 视频压缩编码要求和可能性

##### 1.3.1 视频压缩编码目标

​	将视频信号在传送前先进行压缩编码，即进行视频源压缩编码，然后在网络上进行传送，以便节省传送带宽和存储空间。这里有两个要求:

​	1) 必须压缩在一定的带宽内，即视频编码器应具有足够的压缩比;
​	2) 视频信号压缩之后，应保持一定的视频质量。这个视频质量有两个标准:一个为主观质量，

​	由人从视觉上进行评定;一个为客观质量，通常用**信噪比(S/N)**表示。

​	如果不问质量，一味地压缩，虽然压缩比很高，但压缩后严重失真，显然达不到要求;反之，

​	如只讲质量，压缩比太小，也不符合要求。当然，在以上两个要求下，视频编码器的实现应力求简单、易实现、成本低、可靠性高，这也是基本的要求。

##### 1.3.2 视频压缩的可能性

- 预测编码

  ​	大量的统计 表明，同一幅图像中像素之间具有较强的相关性，两个像素之间的距离越短，则其相关性越强，通俗地讲，即两个像素的值越接近。换言之，两个相邻像素的值发生突变的概率极小，“相等、相似或 缓变”的概率则极大。

  ​	于是，人们可利用这种像素间的相关性进行压缩编码。例如当前像素 X(设为立即传送的像素)

  可用前一个像素 a 或 b、c，或三者的线性加权来预测。这些 a，b，c 被称为参考像素。在实际传送时，把实际像素 X(当前值)和参考像素(预测值)相减，简单起见传送 X-a，到了接收端再把(X-a)+a=X,由于 a 是已传送的(在接收端被存储)，于是得到当前值。由于 X 与 a 相似，(X-a)值很小，视频信号被压缩，这种压缩方式称为**帧内预测编码**。

  ​	不仅如此，还可利用图 1.3 所示的帧间相关性进行压缩编码。由于邻近帧之间的相关性一般比帧内像素间的相关性更强，压缩比也更大。

  ​	由此可见，利用像素之间(帧内)的相关性和帧间的相关性，即找到相应的参考像素或参考帧作为预测值，可以实现视频压缩编码。

- 变换编码

  ​	大量统计表明，**视频信号**中包含着能量上占大部分的直流和低频成分，即**图像的平坦部分**，也

  有少量的高频成分，即图像的细节。

  ​	···

  ​

#### 1.4 视频压缩编码技术综述

​	视频编码方法与可采用的信源模型有关。如果采用“一幅图像由许多像素构成”的信源模型，这种信源模型的参数就是每个像素的亮度和色度的幅度值。对这些参数进行压缩编码技术称为**基于波形的编码**。如果采用一个分量有几个物体构成的信源模型，这种信源模型的参数就是各个物体的形状、纹理和运动。对这些参数进行压缩编码的技术被称为**基于内容的编码**。

​	由此可见，根据采用信源模型，视频编码可以分为两大类，基于波形的编码和基于内容的编码。 它们利用不同的压缩编码方法，得到相应的量化前的参数;再对这些参数进行量化，用二进制码表 示其量化值;最后，进行无损熵编码进一步提高码率。解码则为编码的逆过程。

- 基于波形的编码

  ​	利用像素间的空间相关性和帧间的时间相关性，采用预测编码和变换编码技术可大大减少视频信号的相关性，从而显著降低视频序列的码率，实现压缩编码的目标。 

  ​	基于波形的编码采用了把预测编码和变换编码组合起来的基于块的混合编码方法。

  ​	2003 年 3 月份，ITU-T 颁布了 H.264 视频编码标准。它不仅使视频压缩比较以往标准有明显提 高，而且具有良好的网络亲和性，特别是对 IP 互联网、无线移动网等易误码、易阻塞、QoS 不易保 证的网络视频传输性能有明显的改善。本书的主要内容即 H.264 视频编码。
   	 所有这些视频编码都采用了基于块的混合编码法，都属于基于波形的编码。

- 基于内容的编码

  ​	基于块的编码易于操作，但由于人为地把一幅图像划分成许多固定大小的块，当包含边界的块属于不同物体时，它们分别具有不同的运动，便不能用同一个运动矢量表示该边界块的运动状态。如果强制划分成固定大小的块，这种边界块必然会产生高的预测误差和失真，严重影响了压缩编码信号的质量。

  ​	于是产生了基于内容的编码技术。这时先把视频帧分成对应于不同物体的区域，然后对其编码。 具体说来，即对不同物体的形状、运动和纹理进行编码。在最简单情况下，利用二维轮廓描述物体 的形状;利用运动矢量描述其运动状态;而纹理则用颜色的波形进行描述。
  ​	当视频序列中的物体种类已知时，可采用基于知识或基于模型的编码。例如，对人的脸部，已 开发了一些预定义的线框对脸的特征进行编码，这时编码效率很高，只需少数比特就能描述其特征。对于人脸的表情(如生气、高兴等)，可能的行为可用语义编码，由于物体可能的行为数目非常 小，可获得非常高的编码效率。
  ​	MPEG-4 采用的编码方法就既基于块的混合编码，又有基于内容的编码方法。

- 三维(立体)视频编码

  ​	立体视频编码是视频编码的发展方向之一，其平面信息外增加了深度信息，数据量非常庞大。

  ​	立体视频编码也有两种类型的方法:第一种是基于波形的，它组合运动补偿预测和位差补偿预

  测。所谓位差估计即在两幅不同图像中寻找对应的点。它对预测残差图像、位差和运动矢量进行编码;第二种是基于物体的，它直接对成像物体的三维结构和运动进行编码。当物体结构简单时，可获得非常高的压缩比。

### 第2章 数字视频

​	视频压缩编码技术就是对数字的视频信号进行压缩和解压缩的过程。因此讨论视频压缩编码前， 必须先了解数字视频信号的概念和构成。这是本章的主要内容。

​	什么是数字信号?它是自然电视景象的数字表示。具体说来，在本章中将依次讨论:(1)数字 电视的概念;(2)彩色空间;(3)数字电视景象标准格式;(4)A/D 和 D/A 变换;(5)取样和亚取 样;(6)量化;(7)数字视频的质量。

#### 2.1 数字电视的基本概念

##### 2.1.1 数字电视的优越性

​	现在，模拟彩色电视已经相当普及，在一定程度上满足了人们的生活需求。但是，模拟电视缺陷日益暴露出来。为此，数字电视就应运而生，与模拟电视相比，具有许多突出的优点:

- 失真小、噪声低、质量高

  ​	模拟电视信号在放大、处理、传输、存储过程中，难免会引入失真噪声，而且多种噪声与失真 叠加到电视信号后，不易去除，且会随着处理次数和传输距离的增加不断累积，导致图像质量及信 噪比的下降。

  ​	相反，数字电视信号没有上述的噪声累积效应。如图 2.1 所示，只要噪声电平不超过脉冲幅度 的一半，就可用脉冲再生技术对其整形，并恢复成“0”或“1”两种电平，便不会引入噪声。这样说来， 是否数字电视信号没有任何失真和噪声呢?从下面的叙述可知，它会引入“量化噪声”，这是因为信 号的数字化必须要经过取样、量化、编码三个基本步骤，“量化”是不可缺少的。量化噪声不可避免， 但可控制在相当低的电平一下。

- 易处理、易校正

  ​	模拟电视信号要进行压缩编码处理、加密处理、校正处理都不是一件容易的事情。 

  ​	数字电视信号利用 VLSI 芯片进行压缩编码处理、加密处理、白平衡调整、γ 校正、彩色校正和轮廓校正，相对来说容易得多。随着大规模集成电路设计和工艺的不断发展，现在利用专用芯片和 通用 DSP 来实现以上处理的成本不断下降，这是视频数字压缩编码能取得不断发展的一个重要原因。

-  容量大、节目多

  ​	同样带宽的模拟电路能容纳的数字电视节目比模拟电视节目多得多。例如，CATV 频道中， 550MHz~750MHz 的 200MHz 带宽中，如果传送模拟电视，每个节目需 8MHz 带宽，充其量只能传 送 25 套节目。如果传送数字电视节目，采用 64QAM 调制，其频谱利用率为 5.3，如每路节目用 MPEG-2 压缩为 4Mbps，实际只需 4÷5.3≈0.75MHz 带宽，于是在同样的 200MHz 带宽中可传送数字电视节目数为 200÷0.75≈260，约为模拟电视的 11 倍!

##### 2.1.2 数字电视的 PCM 原理

​	将输入的模拟电视信号变成输出的数字电视信号需经过取样、量化、编码三个步骤，如图 2.2
所示，由 A/D 变换器完成这三个步骤。

1. 取样

   所谓取样，就是在时间轴上把连续变化的模拟信号变为离散量的过程。	

2. 量化

   取样后的脉冲信号在时间上是离散的，但在幅值上空间上仍是连续的，即其可能取的值有无限多个，这就需要对它采用四舍五入的方法，将其可能的幅值数由无限多个变为有限个值。这种将信号幅值由连续量变成离散量的过程称为量化。





































